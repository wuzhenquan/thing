## å‰ç«¯

### å¼€å‘ç¯å¢ƒé…ç½®

#### Proxying API Requests in *Development*

https://facebook.github.io/create-react-app/docs/proxying-api-requests-in-development#configuring-the-proxy-manually

> Keep in mind that `proxy` **only has effect in development** (with `npm start`), and it is up to you to ensure that URLs like `/api/todos` point to the right thing in production. 

```json
// package.json
{"proxy": "http://localhost:3001/"}
```

æ­¤æ—¶ ä¸€å®šè¦å°† 3001 çš„ç«¯å£å¼€èµ·æ¥ï¼Œä¸ç„¶ä¼šæŠ¥é”™ proxy error: Could not proxy request /users/auth from localhost:3000 to http://localhost:3001/.

### ç”Ÿäº§ç¯å¢ƒé…ç½®

https://facebook.github.io/create-react-app/docs/deployment

#### Proxying API Requests in Productionï¼ŸNo

https://github.com/facebook/create-react-app/issues/1087#issuecomment-262611096

è¿™ä¸ª issue ç ´æ¡ˆäº† â€”â€” ä¸æ”¯æŒğŸ˜Šã€‚

æƒ³è¦åœ¨ production ä¸‹æ”¹å˜ base url æœ‰å‡ ä¸ªæ–¹æ³•å¯ä»¥å‚è€ƒä¸‹ã€‚

- > use a production flag, and wrap your choice of http library to change the base url based on the flag. 

- depending on `process.env.NODE_ENV`

- use [`proxy_pass`](https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_pass) when your production server is Nginx. [nzwsch commented on Oct 4](https://github.com/facebook/create-react-app/issues/1087#issuecomment-426916800)

  ```nginx
  upstream backend-server {
    server api.example.com;
  }
  
  server {
    listen 80;
    server_name example.com;
    root /var/www/build;
    index index.html;
  
    location /api/ {
      proxy_pass http://backend-server;
    }
  
    location / {
      try_files $uri /index.html;
    }
  }
  ```

#### Static Server

å¦‚æœä½¿ç”¨çš„æ˜¯ static serverï¼Œé‚£ä¹ˆåªè¦

1. `npm run build`

2. `serve -s build` 

å°±ä¸‡äº‹å¤§å‰äº†ã€‚

#### Building for Relative Paths

å¦‚æœæƒ³ç›´æ¥ä½¿ç”¨æ‰“åŒ…å¥½çš„é™æ€æ–‡ä»¶ï¼ˆwuzhenquan.me/buildï¼‰

1. `npm run build`

2. package.json é‡ŒåŠ å­—æ®µ `"homepage": "build"`

3. nignx 

   ```nginx
   server{
       ...
       location /build {
        root /var/www/thing/frontend/my-app/;
        try_files $uri $uri/index.html;
       }
       ...
   }
   ```

æœ€åçš„æ–¹æ¡ˆ

```javascript
// config.js æ ¹æ® process.env.NODE_ENV æ¥é…ç½®
{ baseUrl:  }
```



## åç«¯

### å¼€å‘ç¯å¢ƒé…ç½®

### ç”Ÿäº§ç¯å¢ƒé…ç½®





