## 前端

### 开发环境配置

#### Proxying API Requests in *Development*

https://facebook.github.io/create-react-app/docs/proxying-api-requests-in-development#configuring-the-proxy-manually

> Keep in mind that `proxy` **only has effect in development** (with `npm start`), and it is up to you to ensure that URLs like `/api/todos` point to the right thing in production. 

```json
// package.json
{"proxy": "http://localhost:3001/"}
```

此时 一定要将 3001 的端口开起来，不然会报错 proxy error: Could not proxy request /users/auth from localhost:3000 to http://localhost:3001/.

### 生产环境配置

https://facebook.github.io/create-react-app/docs/deployment

#### Proxying API Requests in Production？No

https://github.com/facebook/create-react-app/issues/1087#issuecomment-262611096

这个 issue 破案了 —— 不支持😊。

想要在 production 下改变 base url 有几个方法可以参考下。

- > use a production flag, and wrap your choice of http library to change the base url based on the flag. 

- depending on `process.env.NODE_ENV`

- use [`proxy_pass`](https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_pass) when your production server is Nginx. [nzwsch commented on Oct 4](https://github.com/facebook/create-react-app/issues/1087#issuecomment-426916800)

  ```nginx
  upstream backend-server {
    server api.example.com;
  }
  
  server {
    listen 80;
    server_name example.com;
    root /var/www/build;
    index index.html;
  
    location /api/ {
      proxy_pass http://backend-server;
    }
  
    location / {
      try_files $uri /index.html;
    }
  }
  ```

#### Static Server

如果使用的是 static server，那么只要

1. `npm run build`

2. `serve -s build` 

就万事大吉了。

#### Building for Relative Paths

如果想直接使用打包好的静态文件（wuzhenquan.me/build）

1. `npm run build`

2. package.json 里加字段 `"homepage": "build"`

3. nignx 

   ```nginx
   server{
       ...
       location /build {
        root /var/www/thing/frontend/my-app/;
        try_files $uri $uri/index.html;
       }
       ...
   }
   ```

最后的方案

```javascript
// config.js 根据 process.env.NODE_ENV 来配置
{ baseUrl:  }
```



## 后端

### 开发环境配置

### 生产环境配置





